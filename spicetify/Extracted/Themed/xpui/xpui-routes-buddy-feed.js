"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{30665:(e,s,i)=>{i.r(s),i.d(s,{default:()=>Se});var a=i(30758),t=i(98466),r=i(64721),n=i(20618),l=i(6128),c=i(61214),d=i(97500),u=i.n(d),o=i(38364);const m="jGcEaPyhr1c_janM2uRF",x="OemaZktMXaRcYQ5bcfLZ",h="o5IJsOJEWBEyxtPVVVqQ",j="toPt7VOT_PiDx5Gj3SM2",g="xU4sacBisQneHoQeHMP5",f="srjSlmxMGzXnJBc32BJa",p="lju7xv10a5Y5Z8h8CcKJ",y="jr794VV4i2iUBRhfvS5i",N="KE3gK5ccLz2gL3dhJ4BW",b="pO2rsGFqUdaNhpLrif21",v="Ydxgl4Y23orfVVVI9O2k",S="VhqWrkzIrJrvdyj7ZXMd",I="T3liC_3fbMOTilR4HHKD",P="W_tr6AMQB9Chbc9bCS9w",w="yDdNxgieZmqjgHQCW3UE",k="aikUDGtqRnCX0ZwYHDUW",L="T_HXMW6n5qsbLbPTr1GS",R="tYswKV9PmtTCv62LOPIV",_="GlDNRQ2w0t4h9WBI4GgN",B="BQGSV5BvuAaJ5rmFAXLp",Q="ZLbFjRdp1AMXebZH6UWM",T="jhtyHt6d9vbxK6VtCI7a",C="oCaGCB13zdReRutfBS8_",U="MR1n58Qu0kPorQtveOCQ",G="y10vXronmQ6eYMlJrIp3";var D=i(86070);const E=({showOnlineIndicator:e})=>(0,D.jsxs)("div",{className:R,children:[(0,D.jsxs)("div",{className:_,children:[(0,D.jsx)(o.v,{size:"medium"}),e?(0,D.jsx)("div",{className:B}):null]}),(0,D.jsxs)("div",{className:Q,children:[(0,D.jsx)("div",{className:u()(T,C)}),(0,D.jsx)("div",{className:T}),(0,D.jsx)("div",{className:T})]})]}),A=()=>(0,D.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:k,children:[(0,D.jsx)(l.E,{as:"p",className:L,children:r.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,D.jsx)(E,{showOnlineIndicator:!0}),(0,D.jsx)(E,{showOnlineIndicator:!0}),(0,D.jsx)(E,{}),(0,D.jsx)(l.E,{as:"p",className:L,children:r.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,D.jsx)(n.N_,{to:"/preferences",className:U,children:(0,D.jsx)(c.$,{colorSet:"invertedLight",className:G,children:r.Ru.get("desktop.settings.settings")})})]});var M=i(68832),O=i(75627),V=i(57682),W=i(13377),Z=i(58681),H=i(13728),F=i(3602),Y=i(1467),J=i(17221),z=i(39557),K=i(55285),X=i(42163),q=i(27303),$=i(43494),ee=i(48750);const se=e=>{const{timestamp:s,isNowPlaying:i}=e;return i?(0,D.jsx)($.Zp,{label:r.Ru.get("time.now"),children:(0,D.jsx)(q.A,{"aria-label":r.Ru.get("time.now"),size:"small"})}):(0,D.jsx)("span",{children:(0,ee.Z)(s)})};var ie=i(92057),ae=i(89494),te=i(977),re=i(95309),ne=i(88417),le=i(11716),ce=i(24902);const de=e=>Date.now()-e<9e5,ue=(e,s)=>{const i=(0,O.o_h)(e)?.type;switch(i){case O.NQG.PLAYLIST:case O.NQG.PLAYLIST_V2:return(0,D.jsx)(F.W,{uri:e});case O.NQG.EPISODE:case O.NQG.SHOW:return(0,D.jsx)(Y.H,{uri:e});case O.NQG.ALBUM:return(0,D.jsx)(Z.h,{uri:e,artistUri:s});case O.NQG.ARTIST:return(0,D.jsx)(H.t,{uri:e});default:return null}},oe=e=>{switch(e){case O.NQG.ALBUM:return ce.c.ALBUM;case O.NQG.ARTIST:return ce.c.ARTIST;case O.NQG.SHOW:return ce.c.SHOW;case O.NQG.EPISODE:return ce.c.EPISODE;case O.NQG.PLAYLIST:case O.NQG.PLAYLIST_V2:return ce.c.PLAYLIST;default:return}},me=e=>{const{show:s=!0,spec:i,friend:t}=e,n=(0,a.useMemo)((()=>t.user.imageUrl?[{url:t.user.imageUrl,width:0,height:0}]:[]),[t.user.imageUrl]),c=(0,ae.W)(),d=(0,le.s)(),o=t.track,x=o.uri,{togglePlay:h,isPlaying:j,isActive:k}=(0,ne.P)({uri:x},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),L=(0,O.o_h)(o.context?.uri),R=L?.type,_=(0,a.useCallback)((()=>{h(),c({intent:j?"pause":"play",type:"click",itemIdSuffix:"buddyfeed_play",targetUri:x});const e=i.friendRowFactory().playButtonFactory();k?j?d.logInteraction(e.hitPause({itemToBePaused:x})):d.logInteraction(e.hitResume({itemToBeResumed:x})):d.logInteraction(e.hitPlay({itemToBePlayed:x}))}),[c,j,x,i,k,h,d]),B=(0,a.useCallback)(((e,s)=>{d.logInteraction(i.friendRowFactory().friendRowLinkFactory({identifier:e}).hitUiNavigate({destination:s}))}),[d,i]),{draggable:Q,onDragStart:T}=(0,ie.P)({itemUris:[x],dragLabelText:o.name}),{draggable:C,onDragStart:U}=(0,ie.P)({itemUris:[o.artist?.uri],dragLabelText:o.artist?.name}),{draggable:G,onDragStart:E}=(0,ie.P)({itemUris:[o.context?.uri],dragLabelText:o.context?.name});return s?(0,D.jsxs)("div",{className:u()(m),children:[(0,D.jsx)(W.h,{menu:ue(o.context?.uri,o.artist?.uri),children:(0,D.jsxs)("div",{className:g,children:[(0,D.jsx)(V.e,{label:t.user.name,width:40,userIconSize:"small",images:n,withBadge:de(t.timestamp)}),(0,D.jsx)(X.x,{className:f,iconClassName:p,isPlaying:j,isLocked:!1,onClick:_,playAriaLabel:j?r.Ru.get("pause"):`${r.Ru.get("play")} ${o.artist.name} ${o.name}`})]})}),(0,D.jsxs)("div",{className:u()(y),children:[(0,D.jsxs)("div",{className:N,children:[(0,D.jsx)(l.E,{as:"p",variant:"bodySmallBold",className:u()(b,"ellipsis-one-line"),children:(0,D.jsx)(re.pZ,{value:"/buddyfeed_user_profile",children:(0,D.jsx)(W.h,{menu:(0,D.jsx)(z.B,{uri:t.user.uri}),children:(0,D.jsx)(K.N,{title:t.user.name,to:t.user.uri,dir:"auto",onClick:()=>B("profile_link",t.user.uri),children:t.user.name})})})}),(0,D.jsx)(l.E,{as:"p",variant:"marginal",className:u()(v),children:(0,D.jsx)(se,{timestamp:t.timestamp,isNowPlaying:de(t.timestamp)})})]}),(0,D.jsxs)(l.E,{as:"p",variant:"marginal",className:S,children:[(0,D.jsx)(re.pZ,{value:"/buddyfeed_track",children:(0,D.jsx)(W.h,{menu:(0,D.jsx)(J.P,{uri:o.uri,contextUri:o.context?.uri,albumUri:o.album?.uri,artists:[o.artist]}),children:(0,D.jsx)(K.N,{title:o.name,to:x,className:"ellipsis-one-line",dir:"auto",draggable:Q,onDragStart:T,onClick:()=>B("track_link",x),children:o.name})})}),(0,D.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,D.jsx)(re.pZ,{value:"/buddyfeed_artist",children:(0,D.jsx)(W.h,{menu:o.artist?(0,D.jsx)(H.t,{uri:o.artist.uri}):null,children:(0,D.jsx)(K.N,{title:o.artist?.name,to:o.artist?.uri,className:"ellipsis-one-line",dir:"auto",draggable:C,onDragStart:U,onClick:()=>B("artist_link",o.artist?.uri),children:o.artist?.name})})})]}),(0,D.jsx)(l.E,{as:"p",variant:"marginal",className:u()("ellipsis-one-line",P),children:(0,D.jsx)(re.pZ,{value:"/buddyfeed_context",children:(0,D.jsx)(W.h,{menu:ue(o.context?.uri,o.artist?.uri),children:(0,D.jsxs)(K.N,{title:o.context?.name,to:o.context?.uri,className:w,draggable:G,onDragStart:E,onClick:()=>B("context_link",o.context?.uri),children:[(0,D.jsx)(te.s,{type:oe(R),iconSize:16,className:I}),(0,D.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:o.context?.name})]})})})})]})]},t.user.uri):null};var xe=i(65260),he=i(29093),je=i(4316);function ge({friends:e,spec:s}){const{currentSession:i}=(0,je.D)(),t=(0,he.y)(),[r,n]=(0,a.useState)(!0),l=!i?.active&&t&&r&&(0,D.jsx)("li",{className:h,children:(0,D.jsx)(xe.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>n(!1)})},"start-jam-button");return(0,D.jsx)(M.ZI,{flipKey:e.map((e=>e.user.uri)).join(""),children:(0,D.jsxs)("ul",{className:x,children:[l,e.map(((e,i)=>(0,D.jsx)(M.lf,{flipId:e.user.uri,children:(0,D.jsx)("li",{children:(0,D.jsx)(me,{friend:e,show:i<100,spec:s},e.user.uri)})},e.user.uri)))]})})}var fe=i(68376),pe=i(73857),ye=i(78550),Ne=i(2799),be=i(65234),ve=i(1620);const Se=({friends:e})=>{const s=(0,ae.W)(),i=(0,le.s)(),{spec:n}=(0,ve.r)(t.W,{}),l=(0,a.useRef)(null);(0,a.useEffect)((()=>{s({intent:"view",type:"impression",itemIdSuffix:"buddyfeed"})}),[s]),(0,a.useEffect)((()=>{i.logImpression(n.impression())}),[i,n]);const c=0===e.length,d=(0,a.useCallback)((()=>{i.logInteraction(n.closeButtonFactory().hitUiHide())}),[i,n]);return(0,D.jsx)(be.ql.Provider,{value:"buddy_feed",children:(0,D.jsx)(fe._,{label:r.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,D.jsx)("div",{className:j,ref:l,children:(0,D.jsx)(pe.w,{fixedHeader:(0,D.jsx)(ye.a,{title:r.Ru.get("buddy-feed.friend-activity"),panel:Ne.Z.BuddyFeed,onClose:d}),children:c?(0,D.jsx)(A,{}):(0,D.jsx)(ge,{friends:e,spec:n})})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map