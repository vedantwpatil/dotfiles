"use strict";var f=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var v=(s,e)=>{for(var t in e)f(s,t,{get:e[t],enumerable:!0})},D=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let c of C(e))!S.call(s,c)&&c!==t&&f(s,c,{get:()=>e[c],enumerable:!(n=w(e,c))||n.enumerable});return s};var k=s=>D(f({},"__esModule",{value:!0}),s);var V={};v(V,{default:()=>h});module.exports=k(V);var a=require("@raycast/api");var l=require("@raycast/api");var m=require("@raycast/api");var{messageLimit:I}=(0,m.getPreferenceValues)(),M=parseInt(I);var y=(s,e=864e5)=>Date.now()-s>e,o=new l.Cache,O=()=>{o.clear()},A=()=>{if(o.has("accounts")){let s=o.get("accounts");if(s){let{time:e,data:t}=JSON.parse(s);if(!y(e))return t}}},J=s=>A()?.find(e=>e.id===s||e.name===s),L=s=>{o.set("accounts",JSON.stringify({time:Date.now(),data:s}))},i=new l.Cache,P=()=>{i.clear()},g=(s,e)=>{let t=`${s}-${e}`;if(i.has(t)){let n=i.get(t);if(n){let{time:c,data:r}=JSON.parse(n);if(!y(c))return r.slice(0,M)}}return[]},u=(s,e,t)=>{let n=`${e}-${t}`;i.set(n,JSON.stringify({time:Date.now(),data:s}))},$=(s,e,t)=>{let c=[...g(e,t),s];u(c,e,t)},N=(s,e,t,n)=>{let r=g(t,n).map(d=>d.id===s?{...d,...e}:d);u(r,t,n)},F=(s,e,t)=>{let c=g(e,t).filter(r=>r.id!==s);u(c,e,t)},p=Object.freeze({getAccounts:A,setAccounts:L,getAccount:J,invalidateAccounts:O,getMessages:g,setMessages:u,addMessage:$,updateMessage:N,deleteMessage:F,invalidateMessages:P});async function h(){await(0,a.closeMainWindow)(),await(0,a.showToast)(a.Toast.Style.Animated,"Clearing cache"),p.invalidateMessages(),p.invalidateAccounts(),await(0,a.showToast)(a.Toast.Style.Success,"All mails and accounts cleared from cache")}
